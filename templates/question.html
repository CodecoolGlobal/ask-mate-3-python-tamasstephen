<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Question</title>
</head>
<body>
	<a href="/">Back to main page</a>
	<h1>{{ question.title }}</h1>
	<p style="width: 500px">{{ question.message }}</p>
    {% if question_comments %}
        {% for comment in question_comments %}
            <div class="comment">
                <p>{{ comment.message }}</p>
                <div>
                    <p>{{ comment.submission_time }}</p>
                    {% if comment.edited_count %}
                        <p>{{ comment.edited_count }}</p>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    {% endif %}
	{% if question.image %}
		<p>{{ question.image }}</p>
	{% endif %}
    <p><a href="{{ url_for('add_comment_to_question', question_id=question.id) }}">Add comment</a></p>
	<a href="{{ url_for("open_edit_question", question_id=question.id) }}"><p>Edit question</p></a>
	<a href="{{ url_for("add_answer", question_id=question.id) }}"><p>Write an answer</p></a>
	<h3>Answers:</h3>
	<table>
		<thead>
			<tr>
				<th><p>Message</p></th>
				<th><p>Image</p></th>
				<th><p>Votes</p></th>
				<th><p>Action</p></th>
			</tr>
		</thead>
		{% for answer in answers %}
		<tr>
			<td><p>{{ answer.message }}</p></td>
            <td>
                {% if answer_comments %}
                {% for key in answer_comments.keys() %}
                    {% if key == answer.id %}
                        {% for comment in answer_comments[answer.id]  %}
                            <p>{{ comment.message }}</p>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            {% endif %}
            </td>
			<td><p>{{ answer.image }}</p></td>
            <td><p><a href="{{ url_for('add_comment_to_answer', answer_id=answer.id) }}">Add comment</a></p></td>
			<td><p>{{ answer.vote_number }}</p></td>
			<td>
				<form action="{{ url_for("vote_answer_up", answer_id=answer.id ) }}" method="post">
					<input type="submit" value="Vote up">
				</form>
				<form action="{{ url_for("vote_answer_down", answer_id=answer.id ) }}" method="post">
					<input type="submit" value="Vote down">
				</form>
			</td>
			<td>
				<form action="{{ url_for('delete_answer_from_question_page', answer_id=answer.id) }}" method="post">
					<input type="submit" value="Delete answer" >
				</form>
			</td>
		</tr>
		{% endfor %}
	</table>
	<form action={{
	"/question/" + this_question_id + "/delete" }} method="post">
	<input type="submit" name="Delete" value="Delete question">
	</form>
</body>
</html>
